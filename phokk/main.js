import X from"./Box2D.js";var z=(t,b,h)=>{let{b2Color:d,b2Draw:{e_shapeBit:w},b2Transform:_,b2Vec2:a,JSDraw:P,wrapPointer:i}=h,l=e=>new a(e.get_x(),e.get_y()),C=(e,o)=>new a(o*e.get_x(),o*e.get_y()),n=e=>{let o=e.get_r()*255|0,s=e.get_g()*255|0,r=e.get_b()*255|0;return`${o},${s},${r}`},m=e=>{t.fillStyle=`rgba(${e},0.5)`,t.strokeStyle=`rgb(${e})`},k=(e,o)=>{t.beginPath();let s=!0;for(let r of e)s?(t.moveTo(r.get_x(),r.get_y()),s=!1):t.lineTo(r.get_x(),r.get_y());t.closePath(),o&&t.fill(),t.stroke()},A=(e,o,s,r)=>{if(t.beginPath(),t.arc(e.get_x(),e.get_y(),o,0,2*Math.PI,!1),r&&t.fill(),t.stroke(),r){let c=l(e);c.op_add(C(s,o)),t.beginPath(),t.moveTo(e.get_x(),e.get_y()),t.lineTo(c.get_x(),c.get_y()),t.stroke()}},T=(e,o)=>{t.beginPath(),t.moveTo(e.get_x(),e.get_y()),t.lineTo(o.get_x(),o.get_y()),t.stroke()},E=(e,o)=>{let s=o/b;t.fillRect(e.get_x()-s/2,e.get_y()-s/2,s,s)},y=e=>{let o=e.get_p(),s=e.get_q();t.save(),t.translate(o.get_x(),o.get_y()),t.scale(.5,.5),t.rotate(s.GetAngle()),t.lineWidth*=2,t.restore()},V=Float32Array.BYTES_PER_ELEMENT*2,x=(e,o,s,r)=>Array(o).fill(void 0).map((c,p)=>i(e+p*s,r)),F=Object.assign(new P,{DrawSegment(e,o,s){let r=i(s,d);m(n(r));let c=i(e,a),p=i(o,a);T(c,p)},DrawPolygon(e,o,s){let r=i(s,d);m(n(r));let c=x(e,o,V,a);k(c,o,!1)},DrawSolidPolygon(e,o,s){let r=i(s,d);m(n(r));let c=x(e,o,V,a);k(c,o,!0)},DrawCircle(e,o,s){let r=i(s,d);m(n(r));let c=i(e,a),p=new a(0,0);A(c,o,p,!1)},DrawSolidCircle(e,o,s,r){let c=i(r,d);m(n(c));let p=i(e,a),W=i(s,a);A(p,o,W,!0)},DrawTransform(e){let o=i(e,_);y(o)},DrawPoint(e,o,s){let r=i(s,d);m(n(r));let c=i(e,a);E(c,o)}});return F.SetFlags(w),F};var g;function O(t){g=t}function M(t,b,h,d,w,_,a=g.b2_staticBody){let P=new g.b2PolygonShape;P.SetAsBox(d,w);let i=new g.b2BodyDef;i.set_type(a);let l=t.CreateBody(i);return l.CreateFixture(P,1),l.SetTransform(new g.b2Vec2(b,h),_),l.SetEnabled(!0),l}function q(t,b,h){let d=new g.b2CircleShape;d.set_m_radius(.1);let w=new g.b2BodyDef,_=t.CreateBody(w);return _.CreateFixture(d,1).SetSensor(!0),_.SetTransform(new g.b2Vec2(b,h),0),_}function H(t){return new g.b2Vec2(t.get_x(),t.get_y())}X().then(t=>{O(t);let{b2BodyDef:b,b2_dynamicBody:h,b2_kinematicBody:d,b2CircleShape:w,b2PolygonShape:_,b2Vec2:a,b2World:P}=t,i=new a(0,10),l=new P(i),C=document.getElementById("demo-canvas"),n=C.getContext("2d"),m=160,k={x:0,y:0},A=z(n,m,t);l.SetDebugDraw(A);let T=new w;T.set_m_radius(.1);let E=new b;E.set_type(h);let y=l.CreateBody(E);y.CreateFixture(T,1).SetRestitution(.6),y.SetTransform(new a(2,2),1),y.SetBullet(!0);let x=new w;x.set_m_radius(.05);let F=new b;F.set_type(d);let e=l.CreateBody(F),o=e.CreateFixture(x,1),s=new t.b2Filter;s.set_categoryBits(0),o.SetFilterData(s),e.SetTransform(new a(2,1.5),1);let r=M(l,2,4,2,.1,0),c=M(l,2,0,2,.1,0),p=M(l,0,2,.1,1.9,0),W=M(l,4,2,.1,1.9,0),G=q(l,0,0),I=!1,R=()=>{G.SetTransform(new a(.4+3.2*Math.random(),.4+3.2*Math.random()),0)};R();let J=1/60*1e3,N=2,U=2,j=B=>{let S=Math.min(B,J);l.Step(S/1e3,N,U)},Y=()=>{n.closePath(),n.fillStyle="rgb(0,0,0)",n.fillRect(0,0,C.width,C.height),n.save(),n.scale(m,m);let{x:B,y:S}=k;n.translate(B,S),n.lineWidth=2/m,n.fillStyle="white",n.strokeStyle="white";{let{x:u,y:f}=y.GetPosition();n.beginPath(),n.strokeRect(.1,.1,3.8,3.8),n.arc(u,f,T.m_radius,0,Math.PI*2),n.fill()}{let{x:u,y:f}=e.GetPosition();n.beginPath(),n.arc(u,f,x.m_radius,0,Math.PI*2),n.stroke()}{let{x:u,y:f}=G.GetPosition();n.beginPath(),n.setLineDash([.024,.024]),n.arc(u,f,.1,0,Math.PI*2),n.stroke(),n.setLineDash([])}n.fillStyle="rgb(255,255,255)",n.restore()},L=!1;document.body.addEventListener("mousedown",()=>{L=!0}),document.body.addEventListener("mouseup",()=>{L=!1}),document.body.addEventListener("mouseleave",()=>{L=!1});let $=0,v=new t.JSContactListener;v.BeginContact=B=>{let S=t.wrapPointer(B,t.b2Contact),u=[S.GetFixtureA().GetBody(),S.GetFixtureB().GetBody()];u.includes(y)&&u.includes(G)&&(I=!0)},v.PreSolve=()=>{},v.PostSolve=()=>{},v.EndContact=()=>{},l.SetContactListener(v),function B(S){let u=window.performance.now();requestAnimationFrame(B.bind(null,u));let f=u-S;if($+=f,e.SetTransform(new a(Math.sin($*.0015)*1.5+2,1.5),0),I&&(I=!1,R()),L){let D=H(e.GetPosition());D.op_sub(y.GetPosition());let K=4-D.Length(),Q=f*5e-4+K*.001;D.Normalize(),D.op_mul(Q),D.set_y(D.y*1.5),y.ApplyLinearImpulseToCenter(D,!0)}j(f),Y()}(window.performance.now())});
//# sourceMappingURL=main.js.map
